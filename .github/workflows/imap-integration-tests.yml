name: IMAP Integration Tests

on:
    workflow_dispatch:

jobs:
    greenmail-tests:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Install Rust
              uses: dtolnay/rust-toolchain@stable

            - name: Run GreenMail smoke test
              env:
                  GREENMAIL_HOST: "localhost"
                  GREENMAIL_IMAPS_PORT: "3993"
                  GREENMAIL_USER: "test@localhost"
                  GREENMAIL_PASS: "test"
              run: scripts/test-greenmail.sh
